<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì•ˆë‚´ë¬¸ ëª©ë¡</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ccc;
            text-align: center;
            width: 11%; /* ê° ì—´ì˜ í­ì„ ë™ì¼í•˜ê²Œ ì„¤ì • */
        }
    </style>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <h1>ì•ˆë‚´ë¬¸ ëª©ë¡</h1>
    <a href="/notices/new">ìƒˆ ì•ˆë‚´ë¬¸ ì‘ì„±</a>
    <table>
        <thead>
            <tr>
                <th>ì œëª©</th>
                <th>ì‘ì„±ì¼</th>
                <th>ìˆ˜ì •ì¼</th>
                <th>ì¤‘êµ­ì–´ ê°„ì²´</th>
                <th>ì¤‘êµ­ì–´ ë²ˆì²´</th>
                <th>ì¼ë³¸ì–´</th>
                <th>ì˜ì–´</th>
                <th>ë² íŠ¸ë‚¨ì–´</th>
                <th>ìˆ˜ì • ë° ì‚­ì œ</th>
            </tr>
        </thead>
        <tbody>
            <% 
            const getStatus = (finalSavedAt, updatedAt) => {
                if (!finalSavedAt) return 'ğŸ”´'; // ì¡°ê±´ 1: finalSavedAtì´ ë¹ˆê°’
                if (updatedAt && finalSavedAt < updatedAt) return 'ğŸŸ¡'; // ì¡°ê±´ 2: finalSavedAt < updatedAt
                return 'ğŸŸ¢'; // ì¡°ê±´ 3: finalSavedAt > updatedAt ë˜ëŠ” updatedAtì´ ë¹ˆê°’
            };
            %>
            <% notices.forEach(notice => { %>
                <tr>
                    <td>
                      <a href="/notices/translate/<%= notice._id %>"><%= notice.title %></a>
                      <a href="/notices/<%= notice.shortId %>?lang=ko">ğŸ”—</a>
                    </td>
                    <td><%= notice.createdAt.toLocaleDateString() %><br><%= notice.createdBy ? notice.createdBy : '' %></td>
                    <td><%= notice.updatedAt ? notice.updatedAt.toLocaleDateString() : '' %><br><%= notice.updatedBy ? notice.updatedBy : '' %></td>
                    <td>
                        <a href="/notices/<%= notice.shortId %>?lang=sc"><%= getStatus(notice.translations.sc?.finalSavedAt, notice.updatedAt) %></a>
                        <a href="#" onclick="copyToClipboard('<%= notice.translations.sc?.final.join(' ') %>')">ğŸ“‹</a><br>
                        <%= notice.translations.sc?.finalSavedBy ? notice.translations.sc.finalSavedBy : '' %></td>
                    <td>
                        <a href="/notices/<%= notice.shortId %>?lang=tc"><%= getStatus(notice.translations.tc?.finalSavedAt, notice.updatedAt) %></a>
                        <a href="#" onclick="copyToClipboard('<%= notice.translations.tc?.final.join(' ') %>')">ğŸ“‹</a><br>
                        <%= notice.translations.tc?.finalSavedBy ? notice.translations.tc.finalSavedBy : '' %></td>
                    <td>
                        <a href="/notices/<%= notice.shortId %>?lang=jp"><%= getStatus(notice.translations.jp?.finalSavedAt, notice.updatedAt) %></a>
                        <a href="#" onclick="copyToClipboard('<%= notice.translations.jp?.final.join(' ') %>')">ğŸ“‹</a><br>
                        <%= notice.translations.jp?.finalSavedBy ? notice.translations.jp.finalSavedBy : '' %></td>
                    <td>
                        <a href="/notices/<%= notice.shortId %>?lang=en"><%= getStatus(notice.translations.en?.finalSavedAt, notice.updatedAt) %></a>
                        <a href="#" onclick="copyToClipboard('<%= notice.translations.en?.final.join(' ') %>')">ğŸ“‹</a><br>
                        <%= notice.translations.en?.finalSavedBy ? notice.translations.en.finalSavedBy : '' %></td>
                    <td>
                        <a href="/notices/<%= notice.shortId %>?lang=vi"><%= getStatus(notice.translations.vi?.finalSavedAt, notice.updatedAt) %></a>
                        <a href="#" onclick="copyToClipboard('<%= notice.translations.vi?.final.join(' ') %>')">ğŸ“‹</a><br>
                        <%= notice.translations.vi?.finalSavedBy ? notice.translations.vi.finalSavedBy : '' %></td>
                    <td>
                        <a href="/notices/edit/<%= notice._id %>">ìˆ˜ì •</a>
                        <form action="/notices/delete/<%= notice._id %>" method="POST" style="display:inline;">
                            <button type="submit">ì‚­ì œ</button>
                        </form>
                    </td>
                </tr>
            <% }) %>
        </tbody>
    </table>

    <script>
      function copyToClipboard(text) {
          if (text.trim().length > 0) {
              const textarea = document.createElement('textarea');
              textarea.value = text;
              document.body.appendChild(textarea);
              textarea.select();
              document.execCommand('copy');
              document.body.removeChild(textarea);
              alert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
          }
      }
      </script>
</body>
</html>
